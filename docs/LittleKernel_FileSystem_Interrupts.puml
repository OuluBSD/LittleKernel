@startuml LittleKernel_FileSystem_Interrupts

title LittleKernel File System and Interrupts

package "File System" {
  class FsNode {
    - char name[128]
    - uint32 mask
    - uint32 uid
    - uint32 gid
    - uint32 flags
    - uint32 inode
    - uint32 length
    - uint32 impl
    - ReadType_t read
    - WriteType_t write
    - OpenType_t open
    - CloseType_t close
    - ExecType_t execute
  }

  interface ReadType_t {
    + operator()(struct FsNode*, uint32 offset, uint32 size, uint8* buffer) : uint32
  }

  interface WriteType_t {
    + operator()(struct FsNode*, uint32 offset, uint32 size, uint8* buffer) : uint32
  }

  interface OpenType_t {
    + operator()(struct FsNode*) : void
  }

  interface CloseType_t {
    + operator()(struct FsNode*) : void
  }

  interface ExecType_t {
    + operator()(struct FsNode*, uint32 argc, char **argv) : int
  }

  class InitrdHeader {
    - uint32 nfiles
  }

  class InitrdFileHeader {
    - uint8 magic
    - int8 name[64]
    - uint32 offset
    - uint32 length
  }

  class DirectoryEntity {
    - FsNode *node
    - struct DirectoryEntity *next
  }
}

package "Interrupt System" {
  class Interrupts {
    + RegisterInterruptHandler(uint8 n, Callback1<Registers> handler) : void
    + ResetInterruptHandlers() : void
    + EnableInterrupts() : void
    + DisableInterrupts() : void
  }

  class isr_handler {
    + isr_handler(Registers regs) : void
  }

  class irq_handler {
    + irq_handler(Registers regs) : void
  }

  enum IRQ_Numbers {
    IRQ0 = 32
    IRQ1 = 33
    IRQ2 = 34
    IRQ3 = 35
    IRQ4 = 36
    IRQ5 = 37
    IRQ6 = 38
    IRQ7 = 39
    IRQ8 = 40
    IRQ9 = 41
    IRQ10 = 42
    IRQ11 = 43
    IRQ12 = 44
    IRQ13 = 45
    IRQ14 = 46
    IRQ15 = 47
  }
}

@enduml